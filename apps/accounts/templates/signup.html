{% extends 'base.html' %}
{% block content %}
<style>
    #particles-js {
        width: 100%;
        height: 100%;
        position: fixed;
        top: 0;
        left: 0;
        z-index: -1;
        background-image: url("/static/image/bg.png");
        background-repeat: no-repeat;
        background-size: cover;
        background-position: center;

        /* oscurecer la imagen */
        background-blend-mode: multiply;
        background-color: rgba(0, 0, 0, 0.5);

    }

</style>

<div id="particles-js"></div>
<div class="container px-4 px-lg-5">
    <div class="row gx-4 gx-lg-5 justify-content-center vh-100 align-items-center">
        <div class="col-xl-5 col-lg-6 col-md-8 col-11 ">

            <div class="card rounded-3 text-center transparent-card">
                <div class="card-body">
                    <h3 class="title">Registrarse</h3>

                    {% if error %}
                    <div class="alert alert-danger alert-dismissible fade show mt-3 mb-3" role="alert">
                        <div class="error">
                            <span class="mb-0">{{ error }}</span>
                        </div>
                        <button type="button" class="btn-close" data-bs-dismiss="alert" aria-label="Cerrar"></button>
                    </div>
                    {% endif %}

                    <form method="POST">
                        {% csrf_token %}

                        <div class="form-row mb-4 position-relative">
                            <input type="text" class="form-control user-form" name="username" id="username"
                                placeholder="Nombre de usuario" maxlength="30" autofocus>
                            <i class="fas fa-user"
                                style="position: absolute; top: 35%; right: 20px; color: rgba(255, 255, 255, 0.8);"></i>
                        </div>

                        <div class="form-row mb-4 position-relative">
                            <input type="password" class="form-control user-form" name="password1" id="password1"
                                placeholder="Contraseña" maxlength="30" autocomplete="off">
                            <i class="fas fa-lock"
                                style="position: absolute; top: 35%; right: 20px; color: rgba(255, 255, 255, 0.8);"></i>
                        </div>

                        <div class="form-row mb-4 position-relative">

                            <input type="password" class="form-control user-form" name="password2" id="password2"
                                placeholder="Confirmar contraseña" maxlength="30" autocomplete="off">
                            <i class="fas fa-lock"
                                style="position: absolute; top: 35%; right: 20px; color: rgba(255, 255, 255, 0.8);"></i>
                        </div>

                        <div class="form-row mb-4">
                            <button class="btn btn-accounts w-100">Registrarse</button>
                        </div>

                    </form>

                    <div>
                        <p id="small-text">¿Ya tienes una cuenta? <a class="fw-semibold" id="text-links"
                                href="/accounts/signin">Inicia
                                sesión</a></p>
                    </div>

                </div>
            </div>
        </div>
    </div>
</div>

<script>
    document.getElementById("username").addEventListener("input", function () {
        const username = this.value.trim();
        const usernameField = document.getElementById("username");
        if (username !== "" && username.length >= 4) {
            // Realiza una solicitud AJAX al servidor para verificar el nombre de usuario
            $.ajax({
                url: 'check_username_availability/',
                method: 'POST',
                data: {
                    'username': username,
                    'csrfmiddlewaretoken': '{{ csrf_token }}'
                },
                success: function (data) {
                    if (data.is_taken) {
                        usernameField.classList.add("is-invalid");
                        usernameField.classList.remove("is-valid");
                    } else {
                        usernameField.classList.add("is-valid");
                        usernameField.classList.remove("is-invalid");
                    }
                }
            });
        }
        else {
            usernameField.classList.remove("is-valid");
            usernameField.classList.remove("is-invalid");
        }
    });
</script>
<!-- particles.js lib -->
<script src="http://cdn.jsdelivr.net/particles.js/2.0.0/particles.min.js"></script> <!-- stats.js lib -->

<script>
    particlesJS("particles-js", {
        "particles": {
            "number": {
                "value": 100, // Aumenta la cantidad de partículas para una apariencia más densa
                "density": {
                    "enable": true,
                    "value_area": 800
                }
            },
            "color": {
                "value": "#FFFF00" // Cambia el color de las partículas
            },
            "shape": {
                "type": "edge", // Cambia la forma de las partículas
                "stroke": {
                    "width": 0,
                    // Amarillo saturado o brillante
                    "color": "#FFFF00"
                },
            },
            "opacity": {
                "value": 1,
                "random": true,
                "anim": {
                    "enable": false,
                    "speed": 1,
                    "opacity_min": 0.5,
                    "sync": false
                }
            },
            "size": {
                "value": 3, // Reduce el tamaño de las partículas
                "random": true, // Tamaño aleatorio
                "anim": {
                    "enable": true,
                    "speed": 3,
                    "size_min": 0.5,
                    "sync": false
                }
            },
            "line_linked": {
                "enable": false,
            },
            "move": {
                "enable": true,
                "speed": 1, // Aumenta la velocidad de movimiento
                "direction": "none", // Elimina la dirección predefinida
                "random": true, // Dirección aleatoria
                "straight": false, // Movimiento no lineal
                "out_mode": "out",
                "bounce": false,
                "attract": {
                    "enable": false
                }
            }
        },
        "interactivity": {
            "detect_on": "window",
            "events": {
                "onhover": {
                    "enable": false,
                    "mode": "repulse"
                },
                "onclick": {
                    "enable": true,
                    "mode": "repulse"
                },
                "resize": true
            },
            "modes": {
                "repulse": {
                    "distance": 200,
                    "duration": 0.4 // Reduce el tiempo de repulsión de las partículas 
                },
                "push": {
                    "particles_nb": 4
                },
                "remove": {
                    "particles_nb": 2
                }
            }
        },
        "retina_detect": true // Detecta la resolución de la pantalla 
    });
</script>
{% endblock %}